MOV R1, SP
MOV R2, 5
SUB R1, R2
MOV R2, "Write"
MOV R1, [R1]
EQ R1, R2
JZ R1, 62
MOV R1, SP
MOV R2, 4
SUB R1, R2
MOV R2, [R1]
ADD R1, 1
MOV R3, [R1]
ADD R1, 1
MOV R4, [R1]
MOV R5, 5
PUSH R5
PUSH R2
PUSH R3
PUSH R4
PUSH R5
INT 7
POP R1
POP R2
POP R2
POP R2
POP R2
MOV R2, SP
MOV R3, 1
SUB R2, R3
MOV [R2], R1
MOV R1, SP
MOV R2, 5
SUB R1, R2
MOV R2, "Read"
MOV R1, [R1]
EQ R1, R2
JZ R1, 124
MOV R1, SP
MOV R2, 4
SUB R1, R2
MOV R2, [R1]
ADD R1, 1
MOV R3, [R1]
ADD R1, 1
MOV R4, [R1]
MOV R5, 7
PUSH R5
PUSH R2
PUSH R3
PUSH R4
PUSH R5
INT 6
POP R1
POP R2
POP R2
POP R2
POP R2
MOV R2, SP
MOV R3, 1
SUB R2, R3
MOV [R2], R1
MOV R1, SP
MOV R2, 5
SUB R1, R2
MOV R2, "Exit"
MOV R1, [R1]
EQ R1, R2
JZ R1, 186
MOV R1, SP
MOV R2, 4
SUB R1, R2
MOV R2, [R1]
ADD R1, 1
MOV R3, [R1]
ADD R1, 1
MOV R4, [R1]
MOV R5, 5
PUSH R5
PUSH R2
PUSH R3
PUSH R4
PUSH R5
INT 10
POP R1
POP R2
POP R2
POP R2
POP R2
MOV R2, SP
MOV R3, 1
SUB R2, R3
MOV [R2], R1
MOV R1, SP
MOV R2, 5
SUB R1, R2
MOV R2, "Heapset"
MOV R1, [R1]
EQ R1, R2
JZ R1, 218
MOV R1, 1024
MOV R2, 8
MOV [R1], R2
ADD R2,8
ADD R1,8
MOV R3,2047
GT R3, R1
JZ R3, 218
JMP 204
MOV R1, SP
MOV R2, 5
SUB R1, R2
MOV R2, "Alloc"
MOV R1, [R1]
EQ R1, R2
JZ R1, 256
MOV R1, 1024
MOV R2, SP
MOV R3, 1
SUB R2, R3
MOV R3, [R1]
MOV R0,0
ADD R3, R1
MOV [R2], R3
MOV R2, R1
MOV R3, [R1]
ADD R2, R3
MOV [R1], [R2]
MOV R1, SP
MOV R2, 5
SUB R1, R2
MOV R2, "Free"
MOV R1, [R1]
EQ R1, R2
JZ R1, 288
MOV R1, SP
MOV R2, 4
SUB R1, R2
MOV R3, [R1]
MOV R2, 1024
MOV R1, R3

MOV [R1], [R2]
MOV [R2], R3
RET
